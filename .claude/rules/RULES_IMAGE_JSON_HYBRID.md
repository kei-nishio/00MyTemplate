# 画像+JSON ハイブリッドコーディングルール

## 目的

Figma MCP から取得したデータは以下の特性を持つ:

- **JSON (design context)**: テキスト・色は正確だが、座標ベース（position: absolute 問題）
- **Screenshot**: レイアウトは視覚的に正確だが、文字・色情報が不正確

**両者の長所を組み合わせ、短所を補完する**ことで、保守性・レスポンシブ性・アクセシビリティに優れたコードを生成する。

**重要: ピクセルパーフェクトではなく、レイアウト再現を優先する。**

---

## スクリーンショットから得るべき情報

**目的:** 要素の位置関係（抽象概念）を把握する

### 判断すべきこと

1. **レイアウト方式:**
   - 横並びか、縦並びか
   - flex/grid でいけそうか、absolute が必要そうか
   - JSONで absolute になっていても、画像で見たら単なる中央揃えかどうか

2. **配置:**
   - 左寄せ、中央寄せ、右寄せのどれか
   - 両端揃えか

3. **余白感（ざっくり3段階）:**
   - 詰まっている
   - 普通
   - 広い

**それ以上の細かいpx測定は不要。**

---

## JSONから得るべき情報

**目的:** 具体的な値を取得する

### 取得すべきもの

| 情報                   | 使用データ    | 取得方法               | 厳密度           |
| ---------------------- | ------------- | ---------------------- | ---------------- |
| **テキスト内容**       | 📄 JSON       | extractedValues.texts  | 厳密に取得       |
| **色値**               | 📄 JSON       | extractedValues.colors | 厳密に取得       |
| **画像 URL**           | 📄 JSON       | extractedValues.images | 厳密に取得       |
| **フォントサイズ**     | 📄 JSON       | extractedValues.fonts  | 参考値（近似OK） |
| **フォントウェイト**   | 📄 JSON       | extractedValues.fonts  | 参考値（近似OK） |
| **座標値**             | 📄 JSON       | left/top/width/height  | 判断材料のみ     |

---

## gap値の扱い

**原則:** 画像からもJSONからも正確にはわからない → **想定値でOK**

### 想定値の目安

余白感に応じて以下を使い分ける：

- **詰まっている:** `gap: r(8)` ~ `r(16)`
- **普通:** `gap: r(24)` ~ `r(32)`
- **広い:** `gap: r(40)` ~ `r(64)`

### 重要

明らかに余白感が違う箇所を全部同じgapでまとめない。

**例:**
```scss
// ❌ 全部同じgap
.header { gap: r(24); }
.nav { gap: r(24); }
.content { gap: r(24); }

// ✅ 余白感に応じて変える
.header { gap: r(16); }  // 詰まっている
.nav { gap: r(40); }     // 広い
.content { gap: r(24); } // 普通
```

---

## 実装パターン

### パターン 1: ヘッダー・ナビゲーション

**スクショから判断:**
- ロゴとナビの配置: 横並び（左右）→ `justify-content: space-between`
- ナビ項目: 横並び → `display: flex` + `gap: r(40)`

**JSONから取得:**
- テキスト内容、色値

**実装:**
```scss
.header {
  display: flex;
  justify-content: space-between; // スクショから判断
  align-items: center;
  gap: r(16); // 詰まっている
}

.nav-list {
  display: flex;
  gap: r(40); // 広い
}
```

---

### パターン 2: 中央配置コンテンツ

**スクショから判断:**
- 縦並び、中央揃え → `flex-direction: column` + `align-items: center`

**JSONから取得:**
- テキスト内容、色値

**実装:**
```scss
.content {
  display: flex;
  flex-direction: column; // スクショから判断
  align-items: center;
  gap: r(24); // 普通
}
```

---

### パターン 3: 背景・装飾要素

**スクショから判断:**
- 背景に配置されている → `position: absolute`

**JSONから取得:**
- 画像URL

**注意:** コンテンツ要素は flex/grid で実装、背景・装飾のみ absolute

---

## 禁止事項

### ❌ やってはいけないこと

1. **JSONの座標値をそのまま使う**: `left: 120px; top: 340px;`
2. **スクショから色を推測**: 見た目で `color: #333;` など
3. **JSONに存在しないテキストを追加**

### ✅ やるべきこと

1. **スクショ**: 位置関係を把握（横並び/縦並び、配置）
2. **JSON**: テキスト・色を厳密に取得
3. **gap値**: 想定値でOK、余白感を合わせる

---

## position: absolute が許可される例外

以下の要素のみ許可:

1. 背景画像
2. 装飾要素（ドット、線、図形）
3. オーバーレイ
4. バッジ（"NEW"、"SALE"など）

**それ以外のコンテンツ要素はすべて flexbox/grid で実装**

---

## 検証チェックリスト

コーディング完了後に確認:

- [ ] スクショから横並び/縦並びを判断したか
- [ ] テキスト内容をJSONから取得したか
- [ ] 色値をJSONから取得したか
- [ ] JSONの座標値を直接使用していないか
- [ ] 余白感に応じてgap値を変えたか

---

## まとめ

| 作業               | Screenshot       | JSON           |
| ------------------ | ---------------- | -------------- |
| レイアウト構造決定 | ✅               | ❌             |
| 配置判断           | ✅               | ❌             |
| 余白感判断         | ✅（3段階）      | ❌             |
| gap値設定          | ✅（想定値でOK） | ❌             |
| テキスト取得       | ❌               | ✅（厳密に）   |
| 色値取得           | ❌               | ✅（厳密に）   |
| フォントサイズ     | ❌               | ✅（参考値OK） |
| 画像URL取得        | ❌               | ✅（厳密に）   |

**ピクセルパーフェクトではなく、レイアウト再現を優先する。**
